{"ast":null,"code":"import{api}from'./api';export const authService={login:async credentials=>{try{const response=await api.post('/auth/login',credentials);if(response.token){localStorage.setItem('token',response.token);localStorage.setItem('user',JSON.stringify(response.user));return response;}throw new Error('Authentication failed - no token received');}catch(error){var _error$response,_error$response$data;console.error('Login error:',error);throw new Error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Login failed. Please check your credentials');}},register:async userData=>{try{const urlParams=new URLSearchParams(window.location.search);const klikId=urlParams.get('klikid');const payload=klikId?{...userData,klikId}:userData;const response=await api.post('/auth/register',payload);if(response.token){localStorage.setItem('token',response.token);localStorage.setItem('user',JSON.stringify(response.user));}return response;}catch(error){var _error$response2,_error$response2$data;console.error('Registration error:',error);throw new Error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Registration failed. Please try again');}},verifyEmail:async token=>{try{return await api.post(`/auth/verify-email/${token}`);}catch(error){var _error$response3,_error$response3$data;console.error('Email verification error:',error);throw new Error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Email verification failed');}},logout:()=>{localStorage.removeItem('token');localStorage.removeItem('user');},getCurrentUser:async()=>{try{const user=localStorage.getItem('user');if(user)return JSON.parse(user);const response=await api.get('/auth/user');localStorage.setItem('user',JSON.stringify(response.data));return response.data;}catch(error){console.error('Get user error:',error);localStorage.removeItem('token');throw new Error('Session expired. Please log in again');}},triggerModal:(modalType,data)=>{const modalEvent=new CustomEvent('modal_event',{detail:{modalType,data}});window.dispatchEvent(modalEvent);},showLoginModal:()=>{authService.triggerModal('login',{});},showRegisterModal:()=>{authService.triggerModal('register',{});}};","map":{"version":3,"names":["api","authService","login","credentials","response","post","token","localStorage","setItem","JSON","stringify","user","Error","error","_error$response","_error$response$data","console","data","message","register","userData","urlParams","URLSearchParams","window","location","search","klikId","get","payload","_error$response2","_error$response2$data","verifyEmail","_error$response3","_error$response3$data","logout","removeItem","getCurrentUser","getItem","parse","triggerModal","modalType","modalEvent","CustomEvent","detail","dispatchEvent","showLoginModal","showRegisterModal"],"sources":["/Users/lszydlowski/Desktop/czat_portal/frontend/src/services/authService.js"],"sourcesContent":["import { api } from './api';\n\nexport const authService = {\n  login: async (credentials) => {\n    try {\n      const response = await api.post('/auth/login', credentials);\n      \n      if (response.token) {\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n        return response;\n      }\n      throw new Error('Authentication failed - no token received');\n    } catch (error) {\n      console.error('Login error:', error);\n      throw new Error(error.response?.data?.message || 'Login failed. Please check your credentials');\n    }\n  },\n\n  register: async (userData) => {\n    try {\n      const urlParams = new URLSearchParams(window.location.search);\n      const klikId = urlParams.get('klikid');\n      \n      const payload = klikId ? { ...userData, klikId } : userData;\n      const response = await api.post('/auth/register', payload);\n      \n      if (response.token) {\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n      return response;\n    } catch (error) {\n      console.error('Registration error:', error);\n      throw new Error(error.response?.data?.message || 'Registration failed. Please try again');\n    }\n  },\n\n  verifyEmail: async (token) => {\n    try {\n      return await api.post(`/auth/verify-email/${token}`);\n    } catch (error) {\n      console.error('Email verification error:', error);\n      throw new Error(error.response?.data?.message || 'Email verification failed');\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  },\n\n  getCurrentUser: async () => {\n    try {\n      const user = localStorage.getItem('user');\n      if (user) return JSON.parse(user);\n      \n      const response = await api.get('/auth/user');\n      localStorage.setItem('user', JSON.stringify(response.data));\n      return response.data;\n    } catch (error) {\n      console.error('Get user error:', error);\n      localStorage.removeItem('token');\n      throw new Error('Session expired. Please log in again');\n    }\n  },\n\n  triggerModal: (modalType, data) => {\n    const modalEvent = new CustomEvent('modal_event', { \n      detail: { modalType, data } \n    });\n    window.dispatchEvent(modalEvent);\n  },\n\n  showLoginModal: () => {\n    authService.triggerModal('login', {});\n  },\n\n  showRegisterModal: () => {\n    authService.triggerModal('register', {});\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}