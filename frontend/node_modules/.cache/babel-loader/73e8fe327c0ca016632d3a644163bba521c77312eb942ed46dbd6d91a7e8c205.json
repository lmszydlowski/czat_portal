{"ast":null,"code":"var _jsxFileName = \"/Users/lszydlowski/Desktop/czat_portal/frontend/src/hooks/useWebSocket.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport { WS_URL } from '../config';\nimport { useAuth } from '../context/AuthContext';\nimport { api } from '../services/api';\nimport SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\nimport { config } from '../config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var useWebSocket = () => {\n  _s();\n  const [stompClient, setStompClient] = useState(null);\n  const [lastMessage, setLastMessage] = useState(null);\n  useEffect(() => {\n    // Use secure WebSocket URL\n    const socket = new SockJS(config.wsUrl);\n    const client = Stomp.over(socket);\n    client.connect({}, () => {\n      client.subscribe('/topic/messages', message => {\n        setLastMessage(JSON.parse(message.body));\n      });\n    });\n    setStompClient(client);\n    return () => {\n      if (client) {\n        client.disconnect();\n      }\n    };\n  }, []);\n  const sendMessage = content => {\n    if (stompClient) {\n      stompClient.send(\"/app/chat\", {}, JSON.stringify({\n        content\n      }));\n    }\n  };\n  return {\n    sendMessage,\n    lastMessage\n  };\n};\n_s(useWebSocket, \"OGAiEXPcZsgQmLMNEEeWKGmsfP0=\");\nconst Register = () => {\n  _s2();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const {\n    login\n  } = useAuth();\n  const handleSubmit = async e => {\n    e.preventDefault();\n    try {\n      const response = await api.post('/auth/register', {\n        email,\n        password\n      });\n      if (response.data.token) {\n        login(response.data.token);\n      }\n    } catch (error) {\n      console.error('Registration failed:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"email\",\n      value: email,\n      onChange: e => setEmail(e.target.value),\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"password\",\n      value: password,\n      onChange: e => setPassword(e.target.value),\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      children: \"Register\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s2(Register, \"WtEWoP1yoKWCP00gTqyEPSOx9D0=\", false, function () {\n  return [useAuth];\n});\n_c = Register;\nuseWebSocket = _s3(() => {\n  _s3();\n  const [lastMessage, setLastMessage] = useState(null);\n  const wsRef = useRef(null);\n  useEffect(() => {\n    // Use secure WebSocket URL from config\n    wsRef.current = new WebSocket(WS_URL);\n    wsRef.current.onmessage = event => {\n      const message = JSON.parse(event.data);\n      setLastMessage(message);\n    };\n    return () => {\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n    };\n  }, []);\n  const sendMessage = message => {\n    var _wsRef$current;\n    if (((_wsRef$current = wsRef.current) === null || _wsRef$current === void 0 ? void 0 : _wsRef$current.readyState) === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify(message));\n    }\n  };\n  return {\n    sendMessage,\n    lastMessage\n  };\n}, \"KNDHBNLp+4pzekoyp4HCdG9bYB8=\");\nexport default Register;\nvar _c;\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"names":["useEffect","useRef","useState","WS_URL","useAuth","api","SockJS","Stomp","config","jsxDEV","_jsxDEV","useWebSocket","_s","stompClient","setStompClient","lastMessage","setLastMessage","socket","wsUrl","client","over","connect","subscribe","message","JSON","parse","body","disconnect","sendMessage","content","send","stringify","Register","_s2","email","setEmail","password","setPassword","login","handleSubmit","e","preventDefault","response","post","data","token","error","console","onSubmit","children","type","value","onChange","target","required","fileName","_jsxFileName","lineNumber","columnNumber","_c","_s3","wsRef","current","WebSocket","onmessage","event","close","_wsRef$current","readyState","OPEN","$RefreshReg$"],"sources":["/Users/lszydlowski/Desktop/czat_portal/frontend/src/hooks/useWebSocket.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { WS_URL } from '../config';\nimport { useAuth } from '../context/AuthContext';\nimport { api } from '../services/api';\nimport SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\nimport { config } from '../config';\n\nexport var useWebSocket = () => {\n  const [stompClient, setStompClient] = useState(null);\n  const [lastMessage, setLastMessage] = useState(null);\n\n  useEffect(() => {\n    // Use secure WebSocket URL\n    const socket = new SockJS(config.wsUrl);\n    const client = Stomp.over(socket);\n\n    client.connect({}, () => {\n      client.subscribe('/topic/messages', (message) => {\n        setLastMessage(JSON.parse(message.body));\n      });\n    });\n\n    setStompClient(client);\n\n    return () => {\n      if (client) {\n        client.disconnect();\n      }\n    };\n  }, []);\n\n  const sendMessage = (content) => {\n    if (stompClient) {\n      stompClient.send(\"/app/chat\", {}, JSON.stringify({ content }));\n    }\n  };\n\n  return { sendMessage, lastMessage };\n};\n\nconst Register = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const { login } = useAuth();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const response = await api.post('/auth/register', { email, password });\n      if (response.data.token) {\n        login(response.data.token);\n      }\n    } catch (error) {\n      console.error('Registration failed:', error);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\n      <input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} required />\n      <button type=\"submit\">Register</button>\n    </form>\n  );\n};\n\nuseWebSocket = () => {\n  const [lastMessage, setLastMessage] = useState(null);\n  const wsRef = useRef(null);\n\n  useEffect(() => {\n    // Use secure WebSocket URL from config\n    wsRef.current = new WebSocket(WS_URL);\n\n    wsRef.current.onmessage = (event) => {\n      const message = JSON.parse(event.data);\n      setLastMessage(message);\n    };\n\n    return () => {\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n    };\n  }, []);\n\n  const sendMessage = (message) => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify(message));\n    }\n  };\n\n  return { sendMessage, lastMessage };\n};\n\nexport default Register;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}